

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>backtester &mdash; ctxalgoctp 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ctxalgoctp 0.1 documentation" href="../index.html"/>
        <link rel="up" title="ctp" href="index.html"/>
        <link rel="next" title="trading_account" href="trading_account.html"/>
        <link rel="prev" title="exchanges" href="exchanges.html"/> 

  
  <script src="../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> ctxalgoctp
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ctp</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="live/index.html">live</a></li>
<li class="toctree-l2"><a class="reference internal" href="factories/index.html">factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="context_loaders/index.html">context_loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_gen/index.html">code_gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="trade_executors/index.html">trade_executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="logger/index.html">logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="execution_drivers/index.html">execution_drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_producers/index.html">data_producers</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategies/index.html">strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading_account_loaders/index.html">trading_account_loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="slippage_models.html">slippage_models</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategy_utils.html">strategy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="exchanges.html">exchanges</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">backtester</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading_account.html">trading_account</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategy_command_line_utils.html">strategy_command_line_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="report_pdf_generator.html">report_pdf_generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="position_utils.html">position_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="offline_optimization.html">offline_optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="tick_and_bar_publisher.html">tick_and_bar_publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="market_data_feed.html">market_data_feed</a></li>
<li class="toctree-l2"><a class="reference internal" href="base.html">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="order_cancellation.html">order_cancellation</a></li>
<li class="toctree-l2"><a class="reference internal" href="roll.html">roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="state_utils.html">state_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html">constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="dominant_provider.html">dominant_provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="datetime_utils.html">datetime_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategy.html">strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="callback_base.html">callback_base</a></li>
<li class="toctree-l2"><a class="reference internal" href="market_order_simulator.html">market_order_simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="plain_backtester.html">plain_backtester</a></li>
<li class="toctree-l2"><a class="reference internal" href="live_strategy_utils.html">live_strategy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="backtesting_utils.html">backtesting_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="comm.html">comm</a></li>
<li class="toctree-l2"><a class="reference internal" href="report_generator.html">report_generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="future_info_provider.html">future_info_provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading_constants.html">trading_constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="report.html">report</a></li>
<li class="toctree-l2"><a class="reference internal" href="position_rebalancer.html">position_rebalancer</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ctxalgoctp</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">ctp</a> &raquo;</li>
      
    <li>backtester</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../sources/ctp/backtester.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-ctxalgoctp.ctp.backtester">
<span id="backtester"></span><h1>backtester<a class="headerlink" href="#module-ctxalgoctp.ctp.backtester" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="ctxalgoctp.ctp.backtester.CtpAbstractBacktester">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.backtester.</code><code class="descname">CtpAbstractBacktester</code><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpAbstractBacktester" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpAbstractBacktester.backtest">
<code class="descname">backtest</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpAbstractBacktester.backtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform backtesting.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpAbstractBacktester.data_feed">
<code class="descname">data_feed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpAbstractBacktester.data_feed" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the data feed.
:return: AbstractDataFeed, the data feed, None if no data feed is set.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktesterTimes">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.backtester.</code><code class="descname">CtpBacktesterTimes</code><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktesterTimes" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="attribute">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktesterTimes.default_start_time">
<code class="descname">default_start_time</code><em class="property"> = datetime.time(0, 0)</em><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktesterTimes.default_start_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktesterTimes.default_end_time">
<code class="descname">default_end_time</code><em class="property"> = datetime.time(23, 59, 59)</em><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktesterTimes.default_end_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ctxalgoctp.ctp.backtester.SlowMotion">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.backtester.</code><code class="descname">SlowMotion</code><span class="sig-paren">(</span><em>enabled</em>, <em>start_time</em>, <em>end_time</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.SlowMotion" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class that represents slow motion config in backtesting.
When slow motion in backtesting is enabled, the backtesting will slow down to roughly the same
as real time, so some real-time related components such as flow-control can be easily tested.</p>
<p>To enable slow motion mode, a start time and end time also needs to be specified, this means
that backtesting will only slow down between start time and end time. This allows you to
slow down the backtesting only during the time range of interest.</p>
<p>Initialize current.
:param enabled: bool, if True, slow motion is enabled.
:param start_time: time or string in form of HH:MM:SS, the start time of the slow motion mode.
:param end_time: time or string in form of HH:MM:SS, the end time of the slow motion mode.</p>
</dd></dl>

<dl class="class">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.backtester.</code><code class="descname">CtpBacktester</code><span class="sig-paren">(</span><em>data_source</em>, <em>strategy_class</em>, <em>strategy_config</em>, <em>account=None</em>, <em>time_step=None</em>, <em>daily_start_time=None</em>, <em>daily_end_time=None</em>, <em>is_eager_order_execution=False</em>, <em>initial_capital=1000000.0</em>, <em>on_strategy_object_created=None</em>, <em>user=None</em>, <em>slippage_model=None</em>, <em>has_commission=True</em>, <em>message_random_delay_enabled=False</em>, <em>strategy_callbacks=None</em>, <em>is_extrapolate_data_allowed=True</em>, <em>future_trading_utils=None</em>, <em>report_has_charting_url=False</em>, <em>security_company=None</em>, <em>data_feed=None</em>, <em>dominant_provider=None</em>, <em>should_report_warning=False</em>, <em>context=None</em>, <em>save_account_and_context_to_file=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ctxalgoctp.ctp.backtester.CtpAbstractBacktester" title="ctxalgoctp.ctp.backtester.CtpAbstractBacktester"><code class="xref py py-class docutils literal"><span class="pre">ctxalgoctp.ctp.backtester.CtpAbstractBacktester</span></code></a></p>
<p>Class to perform backtesting for trading strategies.</p>
<p>Initialize current CTP backtester.
:param data_source: CtpBacktestOhlcGenerator, this generates ohlc bars for each single trading day.
:param strategy_class: the class name of the strategy. It takes the strategy class name and initialization</p>
<blockquote>
<div>parameters instead of a strategy object because usually a strategy object contains intra-day states.
And these states need to be reset when the next trading day arrives or in the case of backtesting,
when the next trading day&#8217;s simulation starts. By taking the strategy class name and
initialization parameters, the current backtester will create a new strategy object every trading day,
thus approximate the configuration when the strategy is run for real-time trading.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>strategy_config</strong> &#8211; dict from string to objects. The configuration used to create strategy objects.</li>
<li><strong>account</strong> &#8211; TradingAccount, the trading account used for backtesting.
The account will be modified during the backtesting if the strategy involves opening or closing positions.</li>
<li><strong>time_step</strong> &#8211; int, How fast does time move forward in milliseconds.
This is usually set to have the same periodicity of the data ohlc bar from ohlc_generator.
For example, if a ohlc bar is one-minute each bar, then this time_step_in_milliseconds should be
set to 60 * 1000 milliseconds. If the ohlc bar is 1 second, then it should be set to 1 * 1000 milliseconds.
time_step_in_milliseconds can be smaller than the ohlc bar length (meaning that you
want to model more precise time forwarding), but SHOULD NOT be larger.</li>
<li><strong>daily_start_time</strong> &#8211; time.</li>
<li><strong>daily_end_time</strong> &#8211; time. daily_start_time and daily_end_time defines when
the daily simulation should starts and when it should ends. The strategy is usually designed
to be executed on a daily bases. Meaning that on a trading day, the strategy starts some time before the
market starts and it ends some time after the market ends. daily_start_time and daily_end_time is used
to simulate this period.</li>
<li><strong>initial_capital</strong> &#8211; double, the initial capital to use in case account is None.</li>
<li><strong>user</strong> &#8211; string, the trading account id. Usually, you don&#8217;t need to provide
this trading account id, leaving it as None is fine. In such a case, the backtester will
set a dummy trading account id. You need to set an explicit trading account id if you want to test
strategy control-flow.</li>
<li><strong>slippage_model</strong> &#8211; AbstractSlippageModel, the slippage model to use for the backtester.
If None, VolumeBasedSlippageModel will be used.</li>
<li><strong>has_commission</strong> &#8211; bool, if True, all trades have normal commission.
If False, all trades have zero commission. Useful for initial stage strategy research.</li>
<li><strong>message_random_delay_enabled</strong> &#8211; bool, should random delay of trading and market queue
messages be enabled?</li>
<li><strong>strategy_callbacks</strong> &#8211; AbstractStrategyCallbacks, if not None, provides external strategy callbacks
which will be invoked when strategy level callbacks happen. It is useful to attach new behavior
to the existing strategy code without change the code itself.</li>
<li><strong>report_has_charting_url</strong> &#8211; boolean, if True, the returned report contains urls used for charting.
Generating charting urls takes time, so if you don&#8217;t need them, set this parameter to False.</li>
<li><strong>is_extrapolate_data_allowed</strong> &#8211; boolean, If True, when executing limit orders, allow the use of
ask and bid prices to fill orders for specified limit price even such price is not seen at traded prices.</li>
<li><strong>security_company</strong> &#8211; string, security company. Different companies may have different commission rates,
margin, etc. If None, use a default company.</li>
<li><strong>data_feed</strong> &#8211; AbstractDataFeed, external data feed.</li>
<li><strong>context</strong> &#8211; string or dict, existing context, if any.
If a string, and it points to an existing file, load the context from that file.
If a string, and it does not point to an existing file, treat the string as a JSON string and load context
from that string.
If dict, use the content as context.</li>
<li><strong>save_account_and_context_to_file</strong> &#8211; bool, if True, save account and context information into file.
Will slow down backtesting.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.initial_capital">
<code class="descname">initial_capital</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.initial_capital" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.data_feed">
<code class="descname">data_feed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.data_feed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.set_slow_motion">
<code class="descname">set_slow_motion</code><span class="sig-paren">(</span><em>slow_motion</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.set_slow_motion" title="Permalink to this definition">¶</a></dt>
<dd><p>Set self.slow_motion with slow_motion
:param slow_motion:
:return:</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.set_is_precondition_enabled">
<code class="descname">set_is_precondition_enabled</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.set_is_precondition_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or display precondition evaluation.
:param b: boolean, True means enable, False means disable.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.set_is_postcondition_enabled">
<code class="descname">set_is_postcondition_enabled</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.set_is_postcondition_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or display postcondition evaluation.
:param b: boolean, True means enable, False means disable.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.set_is_invariant_enabled">
<code class="descname">set_is_invariant_enabled</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.set_is_invariant_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or display invariant evaluation.
:param b: boolean, True means enable, False means disable.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.enable_contract">
<code class="descname">enable_contract</code><span class="sig-paren">(</span><em>precondition=True</em>, <em>postcondition=True</em>, <em>invariant=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.enable_contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or disable contract evaluation.
:param precondition: boolean, whether to enable or disable precondition evaluation.</p>
<blockquote>
<div>None means do not change current precondition evaluation setting.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>postcondition</strong> &#8211; boolean, whether to enable or disable postcondition evaluation.
None means do not change current postcondition evaluation setting.</li>
<li><strong>invariant</strong> &#8211; boolean, whether to enable or disable invariant evaluation.
None means do not change current invariant evaluation setting.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.dump_json">
<code class="descname">dump_json</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.dump_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.backtest">
<code class="descname">backtest</code><span class="sig-paren">(</span><em>detailed_report=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.backtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform backtesting on strategy.
param: detailed_report: boolean, if True, generate and return detailed report,</p>
<blockquote>
<div>otherwise, generate and return simple report. Generating the detailed report requires to load
the log file (this will assume that the log file is configured to be generated, which is the
default behavior), and takes more time. Generating the simple report is fast.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>detailed_report</strong> &#8211; boolean, if True, return a full-fledged, detailed report for the backtesting
result; otherwise, return a simplified version of it. The simplified version only contain
a subset of metrics to investigate the backtesting result, but it is faster to build.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">CtpStrategyReport or dict {string: object}.
A perform report of the backtested strategy.If detailed_report is True, the detailed report, whose
type is CtpStrategyReport; Otherwise a simple report (of type dict) containing a few metrics including:
cagr, sharpe ratio, sortino ratio. Keys are metric names, values are metric values.
For a more detailed performance evaluation, use CtpStrategyReport. The performance metrics here
is a simplified version of the more detailed CtpStrategyReport. This simplified version is calculated
directly in the backtesting process so it is faster (compared to CtpStrategyReport, which needs to read
the entire log file first). to get. It saves time when used in parameter optimization.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.is_account_equal">
<code class="descname">is_account_equal</code><span class="sig-paren">(</span><em>account1</em>, <em>account2</em>, <em>info</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.is_account_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Is account1 equal to account2?
:param account1: TradingAccount, one account.
:param account2: TradingAccount, the other account.
:return: boolean, True if account1 and account2 are equal.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.get_ctp_factory">
<code class="descname">get_ctp_factory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.get_ctp_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a factory which generate CTP market and trading objects used for backtesting.
:return: CtpFactoryBacktesting.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.now">
<code class="descname">now</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.now" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current time stamp in the simulator.
:return:</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.trading">
<code class="descname">trading</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.trading" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current CTP trading object.
:return: CtpTradingBacktesting.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpBacktester.is_data_full_ohlc_bar">
<code class="descname">is_data_full_ohlc_bar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpBacktester.is_data_full_ohlc_bar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.backtester.</code><code class="descname">CtpWalkForwardBacktester</code><span class="sig-paren">(</span><em>data_source</em>, <em>strategy_class</em>, <em>strategy_config</em>, <em>walk_forward_config</em>, <em>account=None</em>, <em>time_step=None</em>, <em>daily_start_time=None</em>, <em>daily_end_time=None</em>, <em>is_eager_order_execution=False</em>, <em>initial_capital=1000000.0</em>, <em>slippage_model=None</em>, <em>has_commission=True</em>, <em>message_random_delay_enabled=False</em>, <em>strategy_callbacks=None</em>, <em>is_extrapolate_data_allowed=True</em>, <em>progress_logger=None</em>, <em>report_has_charting_url=False</em>, <em>security_company=None</em>, <em>data_feed=None</em>, <em>should_report_warning=True</em>, <em>context=None</em>, <em>save_account_and_context_to_file=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#ctxalgoctp.ctp.backtester.CtpBacktester" title="ctxalgoctp.ctp.backtester.CtpBacktester"><code class="xref py py-class docutils literal"><span class="pre">ctxalgoctp.ctp.backtester.CtpBacktester</span></code></a></p>
<p>Initialize current instance. The walk_forward_config parameter is a dictionary of configuration about
walk forward back tester, you can use ctxalgoctp.ctp.ctp_optimization.make_walk_forward_config function
to create walk_forward_config dictionary.</p>
<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.backtest">
<code class="descname">backtest</code><span class="sig-paren">(</span><em>detailed_report=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.backtest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.optimize_parameters_for_a_window">
<code class="descname">optimize_parameters_for_a_window</code><span class="sig-paren">(</span><em>window_index</em>, <em>base_folder=None</em>, <em>use_window_specific_output_path=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.optimize_parameters_for_a_window" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.make_offline_optimization_scripts">
<code class="descname">make_offline_optimization_scripts</code><span class="sig-paren">(</span><em>serialized_obj_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.make_offline_optimization_scripts" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.data_feed">
<code class="descname">data_feed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.data_feed" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.dump_json">
<code class="descname">dump_json</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.dump_json" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.enable_contract">
<code class="descname">enable_contract</code><span class="sig-paren">(</span><em>precondition=True</em>, <em>postcondition=True</em>, <em>invariant=True</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.enable_contract" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or disable contract evaluation.
:param precondition: boolean, whether to enable or disable precondition evaluation.</p>
<blockquote>
<div>None means do not change current precondition evaluation setting.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>postcondition</strong> &#8211; boolean, whether to enable or disable postcondition evaluation.
None means do not change current postcondition evaluation setting.</li>
<li><strong>invariant</strong> &#8211; boolean, whether to enable or disable invariant evaluation.
None means do not change current invariant evaluation setting.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.get_ctp_factory">
<code class="descname">get_ctp_factory</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.get_ctp_factory" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a factory which generate CTP market and trading objects used for backtesting.
:return: CtpFactoryBacktesting.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.initial_capital">
<code class="descname">initial_capital</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.initial_capital" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.is_account_equal">
<code class="descname">is_account_equal</code><span class="sig-paren">(</span><em>account1</em>, <em>account2</em>, <em>info</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.is_account_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Is account1 equal to account2?
:param account1: TradingAccount, one account.
:param account2: TradingAccount, the other account.
:return: boolean, True if account1 and account2 are equal.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.is_data_full_ohlc_bar">
<code class="descname">is_data_full_ohlc_bar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.is_data_full_ohlc_bar" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.now">
<code class="descname">now</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.now" title="Permalink to this definition">¶</a></dt>
<dd><p>Return current time stamp in the simulator.
:return:</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_is_invariant_enabled">
<code class="descname">set_is_invariant_enabled</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_is_invariant_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or display invariant evaluation.
:param b: boolean, True means enable, False means disable.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_is_postcondition_enabled">
<code class="descname">set_is_postcondition_enabled</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_is_postcondition_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or display postcondition evaluation.
:param b: boolean, True means enable, False means disable.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_is_precondition_enabled">
<code class="descname">set_is_precondition_enabled</code><span class="sig-paren">(</span><em>b</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_is_precondition_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable or display precondition evaluation.
:param b: boolean, True means enable, False means disable.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_slow_motion">
<code class="descname">set_slow_motion</code><span class="sig-paren">(</span><em>slow_motion</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.set_slow_motion" title="Permalink to this definition">¶</a></dt>
<dd><p>Set self.slow_motion with slow_motion
:param slow_motion:
:return:</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.trading">
<code class="descname">trading</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpWalkForwardBacktester.trading" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current CTP trading object.
:return: CtpTradingBacktesting.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="ctxalgoctp.ctp.backtester.CtpSingleDaySimulator">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.backtester.</code><code class="descname">CtpSingleDaySimulator</code><span class="sig-paren">(</span><em>start_time</em>, <em>end_time</em>, <em>data_source</em>, <em>time_step</em>, <em>is_data_source_tick</em>, <em>future_trading_utils</em>, <em>backtester</em>, <em>is_eager_order_execution=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpSingleDaySimulator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class that simulates a trading strategy for a single trading day.
This is designed because in real-time trading, the strategy is usually designed to run on a daily bases.</p>
<p>Initialize current single day simulator.
:param start_time: time, the time when the simulation starts on a trading day.
:param end_time: time, the time when the simulation ends on a trading day.
:param CtpDataSource, the data source for backtesting.
:param time_step: int.
:param is_eager_order_execution: boolean, if True, execute orders at the last known price, and do not</p>
<blockquote>
<div>wait for the new price data to arrive. Set this it True when using large ohlc bars for backtesting
and reduce slippage and will result in a more realistic execution approximation.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>is_data_source_tick</strong> &#8211; bool, True if the backtesting data source is tick level, False otherwise.
If the backtesting data source is tick level, then eager order execution is disabled.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.set_slow_motion">
<code class="descname">set_slow_motion</code><span class="sig-paren">(</span><em>slow_motion</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.set_slow_motion" title="Permalink to this definition">¶</a></dt>
<dd><p>Set slow motion.
:param slow_motion: SlowMotion, slow motion config.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.now">
<code class="descname">now</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.now" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the timestamp in the simulator.
:return: datetime.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.simulate">
<code class="descname">simulate</code><span class="sig-paren">(</span><em>ohlcs_for_one_day</em>, <em>strategy</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.simulate" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate strategy for a single trading day.
:param ohlcs_for_one_day: [OHLC], the ohlc bars for a single trading day. Each element is the OHLC</p>
<blockquote>
<div>for a different future (in case of multi-future strategy). For a single-future strategy, the
list contains only one element.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>strategy</strong> &#8211; StrategyBase. The strategy to simulate.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.step">
<code class="descname">step</code><span class="sig-paren">(</span><em>callbacks=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtester.CtpSingleDaySimulator.step" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the method to be invoked by the strategy. It performs a step of work.
:param callbacks: [CtpCallbacks], the list of callbacks.
:return bool, True if there is something from the trading message queue the last time when we</p>
<blockquote>
<div>proceed into this step function. This is used to make sure that in backtesting mode,
we process all trading-related messages properly before we terminate the strategy.</div></blockquote>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="trading_account.html" class="btn btn-neutral float-right" title="trading_account" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="exchanges.html" class="btn btn-neutral" title="exchanges" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, .
      Last updated on Dec 24, 2016.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../static/jquery.js"></script>
      <script type="text/javascript" src="../static/underscore.js"></script>
      <script type="text/javascript" src="../static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>