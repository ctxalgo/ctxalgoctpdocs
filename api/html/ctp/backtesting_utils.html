

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>backtesting_utils &mdash; ctxalgoctp 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ctxalgoctp 0.1 documentation" href="../index.html"/>
        <link rel="up" title="ctp" href="index.html"/>
        <link rel="next" title="comm" href="comm.html"/>
        <link rel="prev" title="live_strategy_utils" href="live_strategy_utils.html"/> 

  
  <script src="../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../index.html" class="icon icon-home"> ctxalgoctp
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ctp</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="live/index.html">live</a></li>
<li class="toctree-l2"><a class="reference internal" href="factories/index.html">factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="context_loaders/index.html">context_loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_gen/index.html">code_gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="trade_executors/index.html">trade_executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="logger/index.html">logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="execution_drivers/index.html">execution_drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_producers/index.html">data_producers</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategies/index.html">strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading_account_loaders/index.html">trading_account_loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="slippage_models.html">slippage_models</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategy_utils.html">strategy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="exchanges.html">exchanges</a></li>
<li class="toctree-l2"><a class="reference internal" href="backtester.html">backtester</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading_account.html">trading_account</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategy_command_line_utils.html">strategy_command_line_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="report_pdf_generator.html">report_pdf_generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="optimization.html">optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="offline_optimization.html">offline_optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="tick_and_bar_publisher.html">tick_and_bar_publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="market_data_feed.html">market_data_feed</a></li>
<li class="toctree-l2"><a class="reference internal" href="base.html">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="order_cancellation.html">order_cancellation</a></li>
<li class="toctree-l2"><a class="reference internal" href="roll.html">roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="state_utils.html">state_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html">constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="dominant_provider.html">dominant_provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="datetime_utils.html">datetime_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="strategy.html">strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="callback_base.html">callback_base</a></li>
<li class="toctree-l2"><a class="reference internal" href="market_order_simulator.html">market_order_simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="plain_backtester.html">plain_backtester</a></li>
<li class="toctree-l2"><a class="reference internal" href="live_strategy_utils.html">live_strategy_utils</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">backtesting_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="comm.html">comm</a></li>
<li class="toctree-l2"><a class="reference internal" href="report_generator.html">report_generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="future_info_provider.html">future_info_provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="trading_constants.html">trading_constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="report.html">report</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">ctxalgoctp</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">ctp</a> &raquo;</li>
      
    <li>backtesting_utils</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../sources/ctp/backtesting_utils.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-ctxalgoctp.ctp.backtesting_utils">
<span id="backtesting-utils"></span><h1>backtesting_utils<a class="headerlink" href="#module-ctxalgoctp.ctp.backtesting_utils" title="Permalink to this headline">¶</a></h1>
<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.get_temp_folder">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">get_temp_folder</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.get_temp_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a temporary folder and return its absolute path.
:return: string, the absolute path of the created temporary folder.</p>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.get_data_source">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">get_data_source</code><span class="sig-paren">(</span><em>instrument_ids</em>, <em>base_folder</em>, <em>start_date</em>, <em>end_date</em>, <em>data_period</em>, <em>data_paths=None</em>, <em>line_parser=None</em>, <em>future_trading_utils=None</em>, <em>ohlc_reader=None</em>, <em>with_open_interests=False</em>, <em>order_book_level=0</em>, <em>dominants=False</em>, <em>profits=False</em>, <em>use_mid_ask_bid=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.get_data_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the required data source.
:param instrument_ids: [string], the list of instrument ids whose trading data is retrieved.
:param base_folder: string, the folder to store downloaded data. The data is downloaded from CTX servers.
:param start_date: date or string in form of yyyy-mm-dd, the start date (inclusive) of the data.
:param end_date: date or string in form of yyyy-mm-dd, the end date (inclusive) of the data.
:param data_period: Periodicity, the periodicity of the data to download.
:param data_paths: dict{string: string}, meaning dict{instrument_id: data_file_path},</p>
<blockquote>
<div>it gives the external data for each of the instruments. For an instrument, if its data path is given here,
then the data won&#8217;t be downloaded from CTX servers. The data inside the given file is used directly.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>line_parser</strong> &#8211; Ignore this parameter.</li>
<li><strong>future_trading_utils</strong> &#8211; FutureTradingUtils, the trading utils which provide market periods information.</li>
<li><strong>ohlc_reader</strong> &#8211; AbstractOhlcReader, the reader to read an ohlc from file.
It can be a text reader or a binary reader.
If not None, use this reader to load ohlc data from file, and line_parser will not be used.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">AbstractDataSource.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.safe_get_base_folder">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">safe_get_base_folder</code><span class="sig-paren">(</span><em>strategy_class=None</em>, <em>config=None</em>, <em>folder=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.safe_get_base_folder" title="Permalink to this definition">¶</a></dt>
<dd><p>Return default place for base folder.
:param strategy_class: class, the class of the strategy.
:param config: dict{string: object}, the strategy config.</p>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.get_proper_backtest_data_period">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">get_proper_backtest_data_period</code><span class="sig-paren">(</span><em>backtest_data_period</em>, <em>config</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.get_proper_backtest_data_period" title="Permalink to this definition">¶</a></dt>
<dd><p>Try to decide on a proper backtest data period.
:param backtest_data_period: Periodicity, if not None, return it directly.</p>
<blockquote>
<div>Otherwise, try to decide a proper backtest data period.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>config</strong> &#8211; dict{string: object}, the config object for the strategy.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Periodicity, the decided backtest data period, or None if no proper period can be decided.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.is_date_parameter_valid">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">is_date_parameter_valid</code><span class="sig-paren">(</span><em>date_spec</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.is_date_parameter_valid" title="Permalink to this definition">¶</a></dt>
<dd><p>Is date_spec a valid date specification?
:param date_spec: date or string in form of yyyy-mm-dd.
:return: boolean.</p>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.setup_mission_controller">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">setup_mission_controller</code><span class="sig-paren">(</span><em>controller</em>, <em>strategy</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.setup_mission_controller" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the mission controller inside the given strategy.
:param controller: CtpMissionController, the mission controller.
:param strategy: AbstractStateBasedStrategy, the strategy whose mission controller will be set.</p>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.data_source_for_strategy">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">data_source_for_strategy</code><span class="sig-paren">(</span><em>strategy_class</em>, <em>config_getter</em>, <em>start_date</em>, <em>end_date</em>, <em>line_parser=None</em>, <em>data_paths=None</em>, <em>backtest_data_period=None</em>, <em>ohlc_reader=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.data_source_for_strategy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.backtest">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">backtest</code><span class="sig-paren">(</span><em>strategy_class</em>, <em>config_getter</em>, <em>start_date</em>, <em>end_date</em>, <em>backtest_data_period=None</em>, <em>initial_capital=1000000.0</em>, <em>data_paths=None</em>, <em>line_parser=None</em>, <em>daily_start_time=None</em>, <em>daily_end_time=None</em>, <em>user=None</em>, <em>slippage_model=None</em>, <em>is_eager_order_execution=True</em>, <em>should_profile=False</em>, <em>has_commission=True</em>, <em>message_random_delay_enabled=False</em>, <em>should_print=True</em>, <em>slow_motion=None</em>, <em>strategy_callbacks=None</em>, <em>is_extrapolate_data_allowed=True</em>, <em>report_has_charting_url=True</em>, <em>perform_backtest=True</em>, <em>ohlc_reader=None</em>, <em>security_company=None</em>, <em>data_feed=None</em>, <em>log_in_console=False</em>, <em>dominant_provider=None</em>, <em>mission_control=None</em>, <em>data_source=None</em>, <em>should_report_warning=True</em>, <em>with_open_interests=False</em>, <em>order_book_level=0</em>, <em>dominants=False</em>, <em>profits=False</em>, <em>use_mid_ask_bid=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.backtest" title="Permalink to this definition">¶</a></dt>
<dd><p>Backtest your strategy.
:param strategy_class: class, the class of the strategy.
:param config_getter: A function pointer to return config to run strategy. Or a dict{string: object}, keys are</p>
<blockquote>
<div>parameter names, values are parameter values. If it is a function pointer, the function pointer takes no
arguments, and returns a dict{string: object}.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>start_date</strong> &#8211; date or string in form of yyyy-mm-dd, the start date (inclusive) for backtesting.</li>
<li><strong>end_date</strong> &#8211; date or string in form of yyyy-mm-dd, the end date (inclusive) for backtesting.</li>
<li><strong>backtest_data_period</strong> &#8211; Periodicity, the period for backtesting data.
If None, try to decide on a proper period.</li>
<li><strong>initial_capital</strong> &#8211; float, the initial capital used for the backtesting.</li>
<li><strong>data_paths</strong> &#8211; dict{string: string}, the list of data file paths for instrument_ids.
Keys are instrument ids, values are the data file paths for those instruments.
Used to provide external data files for the backtester.
In tick mode, the paths should be folders, in ohlc bar mode, the paths should be files.</li>
<li><strong>line_parser</strong> &#8211; <p>a function pointer which parses an ohlc line into data.
Function signature: string -&gt; (timestamp, open, high, low, <a href="#id1"><span class="problematic" id="id2">close_</span></a>, volume, amount)
The parameter to the function is a string representing a line in ohlc file.
The return value of the function is a tuple containing the parsed data:</p>
<blockquote>
<div>timestamp: datetime, the timestamp of the ohlc line.
open: float, the open price,
high: float, the high price,
low: float, the low price,
close: float, the close price,
volume: int, the volume,
amount: float, the amount of money that has been traded, if there is no amount data<blockquote>
<div>in the raw text, set this to 0.</div></blockquote>
</div></blockquote>
<p>If line parser is None, a default parser is used.</p>
</li>
<li><strong>daily_start_time</strong> &#8211; time, the time for the backtester to start every day.</li>
<li><strong>daily_end_time</strong> &#8211; time, the time for the backtester to end every day.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>:param user, string, the trading account id. Usually you can leave it as None. You only need to</dt>
<dd>set an explicit trading account id if you want to test the control-flow component.</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>slippage_model</strong> &#8211; AbstractSlippageModel, the slippage model to use for the backtester.
If None, VolumeBasedSlippageModel will be used.</li>
<li><strong>is_eager_order_execution</strong> &#8211; bool, indicates whether pending orders should be executed
at the current known price information, or the backtester waits until the next price to arrive
and then executes pending orders.</li>
<li><strong>should_profile</strong> &#8211; bool, if True, enable the profiler and output
the profiling information to console when backtesting finishes.</li>
<li><strong>has_commission</strong> &#8211; bool, if True, all trades have normal commission.
If False, all trades have zero commission. Useful for initial stage strategy research.</li>
<li><strong>message_random_delay_enabled</strong> &#8211; bool, should random delay of trading and market queue
messages be enabled?</li>
<li><strong>should_print</strong> &#8211; bool, if True, print backtesting result into console.</li>
<li><strong>slow_motion</strong> &#8211; SlowMotion, the slow motion config.</li>
<li><strong>strategy_callbacks</strong> &#8211; AbstractStrategyCallbacks, if not None, provides external strategy callbacks
which will be invoked when strategy level callbacks happen. It is useful to attach new behavior
to the existing strategy code without change the code itself.</li>
<li><strong>is_extrapolate_data_allowed</strong> &#8211; boolean, If True, when executing limit orders, allow the use of
ask and bid prices to fill orders for specified limit price even such price is not seen at traded prices.</li>
<li><strong>report_has_charting_url</strong> &#8211; boolean, if True, the returned report contains urls used for charting.
Generating charting urls takes time, so if you don&#8217;t need them, set this parameter to False.</li>
<li><strong>perform_backtest</strong> &#8211; boolean, if True, perform actual backtesting, if False, do not do any backtesting,
instead, go directly to backtesting result processing. This is useful when you already finished backtesting,
and want to do some processing of the backtesting result.</li>
<li><strong>ohlc_reader</strong> &#8211; AbstractOhlcReader, the reader to read an ohlc from file.
It can be a text reader or a binary reader.
If not None, use this reader to load ohlc data from file, and line_parser will not be used.</li>
<li><strong>security_company</strong> &#8211; string, the security company. Different security company may have different
rates for commission, margin, and this attribute is used to take that into account.
f None, use a default company.</li>
<li><strong>data_feed</strong> &#8211; AbstractDataFeed, data feed.</li>
<li><strong>log_in_console</strong> &#8211; bool, if True and if there is no logger provided in the strategy configuration,
create a default logger which prints logs into console.</li>
<li><strong>dominant_provider</strong> &#8211; AbstractDominantProvider, dominant provider, used for trading relative instrument ids.</li>
<li><strong>mission_control</strong> &#8211; MissionControl, provide the mission controller.</li>
<li><strong>data_source</strong> &#8211; BacktestingDataSource, the external data source, if not None, use this data source.</li>
<li><strong>should_report_warning</strong> &#8211; bool, indicates whether warning in backtesting are reported.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>:return (CtpStrategyReport, AbstractDataSource), backtesting result report, and the data source used by</dt>
<dd>the backtesting sessions. The data source can be used to do charting later.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.walk_forward_optimize">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">walk_forward_optimize</code><span class="sig-paren">(</span><em>strategy_class</em>, <em>config_getter</em>, <em>base_folder</em>, <em>start_date</em>, <em>end_date</em>, <em>optimizer</em>, <em>param_specs</em>, <em>objectives</em>, <em>training_window</em>, <em>testing_window</em>, <em>constraints=None</em>, <em>regularizers=None</em>, <em>testing_start_day=None</em>, <em>backtest_data_period=None</em>, <em>initial_capital=1000000.0</em>, <em>data_paths=None</em>, <em>line_parser=None</em>, <em>is_eager_order_execution=True</em>, <em>slippage_model=None</em>, <em>has_commission=True</em>, <em>strategy_callbacks=None</em>, <em>is_extrapolate_data_allowed=True</em>, <em>should_print=True</em>, <em>report_has_charting_url=True</em>, <em>progress_logger=None</em>, <em>ohlc_reader=None</em>, <em>security_company=None</em>, <em>data_feed=None</em>, <em>data_source=None</em>, <em>should_report_warning=True</em>, <em>with_open_interests=False</em>, <em>order_book_level=0</em>, <em>dominants=False</em>, <em>profits=False</em>, <em>use_mid_ask_bid=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.walk_forward_optimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform walk-forward optimization.
:param strategy_class: Python class name, the class name for the strategy.
:param config_getter: A function to return config to run strategy. Or a dict{string: object}, keys are</p>
<blockquote>
<div>parameter names, values are parameter values.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>base_folder</strong> &#8211; string, the folder to store log file.</li>
<li><strong>start_date</strong> &#8211; date or string in form of yyyy-mm-dd, the start date (inclusive) for backtesting.</li>
<li><strong>end_date</strong> &#8211; date or string in form of yyyy-mm-dd, the end date (inclusive) for backtesting.</li>
<li><strong>optimizer</strong> &#8211; OptimizerConfig from ctxalgolib.ta.optimization.optimization_utils. It contains the
optimizer to use and its options. Use optimization_utils.OptimizerUtils to create the optimizer.</li>
<li><strong>param_specs</strong> &#8211; [ctxalgolib.ta.optimization.parameters.Parameter], the list of parameters used in optimization.</li>
<li><strong>objectives</strong> &#8211; [lambda], list of lambda functions used as optimization objectives (minimization).</li>
<li><strong>training_window</strong> &#8211; int, the length of training window in number of days.</li>
<li><strong>testing_window</strong> &#8211; int, the length of testing window in number of days.</li>
<li><strong>constraints</strong> &#8211; [lambda], list of lambda functions used as constraints over the parameters.</li>
<li><strong>regularizers</strong> &#8211; [cxalgolib.ta.optimization.regularizer.RegularizerBase], list of
regularizers for optimization parameters. None means no regularization.</li>
<li><strong>testing_start_day</strong> &#8211; int, 1-based first day when testing starts. If None, it starts from the first day.</li>
<li><strong>backtest_data_period</strong> &#8211; Periodicity, the period for backtesting data.
If None, try to decide a proper backtest data period.</li>
<li><strong>initial_capital</strong> &#8211; float, the initial capital.</li>
<li><strong>data_paths</strong> &#8211; dict{string: string}, the list of data file paths for instrument_ids.
Keys are instrument ids, values are the OHLC file paths for those instruments.
Used to provide external data files for the backtester.
In tick mode, the paths should be folders, in ohlc bar mode, the paths should be files.</li>
<li><strong>line_parser</strong> &#8211; <p>a function pointer which parses an ohlc line into data.
Function signature: string -&gt; (timestamp, open, high, low, <a href="#id3"><span class="problematic" id="id4">close_</span></a>, volume, amount)
The parameter to the function is a string representing a line in ohlc file.
The return value of the function is a tuple containing the parsed data:</p>
<blockquote>
<div>timestamp: datetime, the timestamp of the ohlc line.
open: float, the open price,
high: float, the high price,
low: float, the low price,
close: float, the close price,
volume: int, the volume,
amount: float, the amount of money that has been traded, if there is no amount data<blockquote>
<div>in the raw text, set this to 0.</div></blockquote>
</div></blockquote>
<p>If line parser is None, a default parser is used.</p>
</li>
<li><strong>is_eager_order_execution</strong> &#8211; bool, indicates whether pending orders should be executed
at the current known price information, or the backtester waits until the next price to arrive
and then executes pending orders.</li>
<li><strong>slippage_model</strong> &#8211; AbstractSlippageModel, the slippage model to use for the backtester.
If None, VolumeBasedSlippageModel will be used.</li>
<li><strong>has_commission</strong> &#8211; bool, if True, all trades have normal commission.
If False, all trades have zero commission. Useful for initial stage strategy research.</li>
<li><strong>strategy_callbacks</strong> &#8211; AbstractStrategyCallbacks, if not None, provides external strategy callbacks
which will be invoked when strategy level callbacks happen. It is useful to attach new behavior
to the existing strategy code without change the code itself.</li>
<li><strong>is_extrapolate_data_allowed</strong> &#8211; boolean, If True, when executing limit orders, allow the use of
ask and bid prices to fill orders for specified limit price even such price is not seen at traded prices.</li>
<li><strong>should_print</strong> &#8211; bool, if True, print backtesting result into console.</li>
<li><strong>report_has_charting_url</strong> &#8211; boolean, if True, the returned report contains urls used for charting.
Generating charting urls takes time, so if you don&#8217;t need them, set this parameter to False.</li>
<li><strong>progress_logger</strong> &#8211; LoggerHandler, the logger to output walk-forward progress.</li>
<li><strong>ohlc_reader</strong> &#8211; AbstractOhlcReader, the reader to read an ohlc from file.
It can be a text reader or a binary reader.
If not None, use this reader to load ohlc data from file, and line_parser will not be used.</li>
<li><strong>security_company</strong> &#8211; string, the security company. Different security company may have different
rates for commission, margin, and this attribute is used to take that into account.
f None, use a default company.</li>
<li><strong>data_feed</strong> &#8211; AbstractDataFeed, data feed.</li>
<li><strong>data_source</strong> &#8211; BacktestingDataSource, the external data source, if not None, use this data source.</li>
<li><strong>should_report_warning</strong> &#8211; bool, indicates whether warning in backtesting are reported.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>:return (CtpStrategyReport, AbstractDataSource), backtesting result report, and the data source used by</dt>
<dd>the backtesting sessions. The data source can be used to do charting later.</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.simulate_or_live_trade">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">simulate_or_live_trade</code><span class="sig-paren">(</span><em>strategy_class</em>, <em>config_getter</em>, <em>base_folder</em>, <em>market_server</em>, <em>trading_server</em>, <em>user</em>, <em>password</em>, <em>broker_id</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.simulate_or_live_trade" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulate or live trade the strategy.
When the market_server, trading_server, user, password and broker_id are for simulation, then the strategy
will run against the simulation environment. If these arguments are for real trading, the the strategy
will run in live trade with real money.
:param strategy_class: class, the class of the strategy.
:param config_getter: A function to return config to run strategy.
:param market_server: string, the server name for market data. In form of <a class="reference external" href="tcp://ddd.ddd.ddd.ddd:port">tcp://ddd.ddd.ddd.ddd:port</a>.
:param trading_server: string, the server name for trading data. In form of <a class="reference external" href="tcp://ddd.ddd.ddd.ddd:port">tcp://ddd.ddd.ddd.ddd:port</a>.
:param user: string, user name.
:param password: string, password.
:param broker_id: string, broker_id.</p>
</dd></dl>

<dl class="function">
<dt id="ctxalgoctp.ctp.backtesting_utils.get_slippage_model">
<code class="descclassname">ctxalgoctp.ctp.backtesting_utils.</code><code class="descname">get_slippage_model</code><span class="sig-paren">(</span><em>name</em>, <em>parameters</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.backtesting_utils.get_slippage_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the slippage model defined by name and parameters.
:param name: string, name of the slippage model.
:param parameters: dict{string: object}, the parameters for the slippage model.</p>
<blockquote>
<div>Keys are parameter names, values are parameter values.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">AbstractSlippageModel.</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="comm.html" class="btn btn-neutral float-right" title="comm" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="live_strategy_utils.html" class="btn btn-neutral" title="live_strategy_utils" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, .
      Last updated on Nov 11, 2016.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../static/jquery.js"></script>
      <script type="text/javascript" src="../static/underscore.js"></script>
      <script type="text/javascript" src="../static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>