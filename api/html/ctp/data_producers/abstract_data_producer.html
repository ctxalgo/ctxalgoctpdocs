

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>abstract_data_producer &mdash; ctxalgoctp 0.1 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="ctxalgoctp 0.1 documentation" href="../../index.html"/>
        <link rel="up" title="data_producers" href="index.html"/>
        <link rel="next" title="zmq_data_producer" href="zmq_data_producer.html"/>
        <link rel="prev" title="backtesting_data_producer" href="backtesting_data_producer.html"/> 

  
  <script src="../../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> ctxalgoctp
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">ctp</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../live/index.html">live</a></li>
<li class="toctree-l2"><a class="reference internal" href="../factories/index.html">factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../context_loaders/index.html">context_loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../code_gen/index.html">code_gen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trade_executors/index.html">trade_executors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logger/index.html">logger</a></li>
<li class="toctree-l2"><a class="reference internal" href="../execution_drivers/index.html">execution_drivers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">data_producers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ctp_data_producer.html">ctp_data_producer</a></li>
<li class="toctree-l3"><a class="reference internal" href="backtesting_data_producer.html">backtesting_data_producer</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">abstract_data_producer</a></li>
<li class="toctree-l3"><a class="reference internal" href="zmq_data_producer.html">zmq_data_producer</a></li>
<li class="toctree-l3"><a class="reference internal" href="fake_data_producer.html">fake_data_producer</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../strategies/index.html">strategies</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trading_account_loaders/index.html">trading_account_loaders</a></li>
<li class="toctree-l2"><a class="reference internal" href="../slippage_models.html">slippage_models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../strategy_utils.html">strategy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exchanges.html">exchanges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtester.html">backtester</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trading_account.html">trading_account</a></li>
<li class="toctree-l2"><a class="reference internal" href="../strategy_command_line_utils.html">strategy_command_line_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../report_pdf_generator.html">report_pdf_generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optimization.html">optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline_optimization.html">offline_optimization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tick_and_bar_publisher.html">tick_and_bar_publisher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../market_data_feed.html">market_data_feed</a></li>
<li class="toctree-l2"><a class="reference internal" href="../base.html">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../order_cancellation.html">order_cancellation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../roll.html">roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../state_utils.html">state_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../constants.html">constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dominant_provider.html">dominant_provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../datetime_utils.html">datetime_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../strategy.html">strategy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../callback_base.html">callback_base</a></li>
<li class="toctree-l2"><a class="reference internal" href="../market_order_simulator.html">market_order_simulator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plain_backtester.html">plain_backtester</a></li>
<li class="toctree-l2"><a class="reference internal" href="../live_strategy_utils.html">live_strategy_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../backtesting_utils.html">backtesting_utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../comm.html">comm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../report_generator.html">report_generator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../utils.html">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="../future_info_provider.html">future_info_provider</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trading_constants.html">trading_constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="../report.html">report</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">ctxalgoctp</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">ctp</a> &raquo;</li>
      
          <li><a href="index.html">data_producers</a> &raquo;</li>
      
    <li>abstract_data_producer</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../sources/ctp/data_producers/abstract_data_producer.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-ctxalgoctp.ctp.data_producers.abstract_data_producer">
<span id="abstract-data-producer"></span><h1>abstract_data_producer<a class="headerlink" href="#module-ctxalgoctp.ctp.data_producers.abstract_data_producer" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer">
<em class="property">class </em><code class="descclassname">ctxalgoctp.ctp.data_producers.abstract_data_producer.</code><code class="descname">AbstractDataProducer</code><span class="sig-paren">(</span><em>dominant_provider</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.set_all_event_queue">
<code class="descname">set_all_event_queue</code><span class="sig-paren">(</span><em>queue</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.set_all_event_queue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.all_event_queue">
<code class="descname">all_event_queue</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.all_event_queue" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.set_dominant_provider">
<code class="descname">set_dominant_provider</code><span class="sig-paren">(</span><em>provider</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.set_dominant_provider" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Connect to market server.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.disconnect">
<code class="descname">disconnect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.disconnect" title="Permalink to this definition">¶</a></dt>
<dd><p>Disconnect to market server.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.prepare_before_run">
<code class="descname">prepare_before_run</code><span class="sig-paren">(</span><em>message_queue</em>, <em>all_event_queue</em>, <em>strategy</em>, <em>ctp_folder</em>, <em>now</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.prepare_before_run" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.is_tick_needed">
<code class="descname">is_tick_needed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.is_tick_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>Should current data producer register for tick data for instruments that subscribe for ohlc data?
For some producers, tick data is always needed. For example, CtpDataProducer.
For other producers such as ZmqDataProducer, if the strategy does not need tick data, no need to
register for tick data. For those data producers, you will have a set_should_enforce_tick method.
:return: bool.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.subscribe_ohlcs">
<code class="descname">subscribe_ohlcs</code><span class="sig-paren">(</span><em>periods</em>, <em>historical_ohlcs</em>, <em>market_periods</em>, <em>trading_day</em>, <em>order_book_level=1</em>, <em>with_open_interest=False</em>, <em>profits=False</em>, <em>use_mid_ask_bid=False</em>, <em>dominants=False</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.subscribe_ohlcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Subscribe ohlcs so a strategy can use those subscribed ohlcs.
:param periods: dict{string: dict{string: [Periodicity or float/int]}}, meaning</p>
<blockquote>
<div>dict{ohlc_kind: dict{instrument_id: [time-based periods or volatility thresholds]}}.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>historical_ohlcs</strong> &#8211; dict{string: dict{string: dict{Periodicity or float/int: OHLC}}}, meaning
dict{ohlc_kind: dict{instrument_id: dict{Periodicity or float/int: OHLC}}}. Historical ohlcs.</li>
<li><strong>market_periods</strong> &#8211; dict{string: [(start_time, end_time)], meaning dict{instrument_id: market_periods},
Market periods for all instruments appearing in periods.</li>
<li><strong>trading_day</strong> &#8211; date, the current trading day.</li>
<li><strong>order_book_level</strong> &#8211; int, order book level.</li>
<li><strong>with_open_interest</strong> &#8211; bool, whether the generated ohlcs contain the open_interest column.</li>
<li><strong>profits</strong> &#8211; bool, whether the generated ohlcs contain the profits column.</li>
<li><strong>use_mid_ask_bid</strong> &#8211; bool, whether to use mid bid ask price to generated ohlcs.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.subscribe_ticks">
<code class="descname">subscribe_ticks</code><span class="sig-paren">(</span><em>periods</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.subscribe_ticks" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.subscribe_tick">
<code class="descname">subscribe_tick</code><span class="sig-paren">(</span><em>instrument_id</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.subscribe_tick" title="Permalink to this definition">¶</a></dt>
<dd><p>Subscribe tick data for the given instrument.
:param instrument_id: string, instrument id.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.reset">
<code class="descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset current data producer.
:return:</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.ohlcs">
<code class="descname">ohlcs</code><span class="sig-paren">(</span><em>kind</em>, <em>instrument_id</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.ohlcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ohlcs that we have so far for the given instrument and ohlc kind.
Refer to AbstractStrategy.ohlcs to see the meaning.
:param kind: string, ohlc kind.
:param instrument_id: string, instrument id.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.ohlc">
<code class="descname">ohlc</code><span class="sig-paren">(</span><em>instrument_id</em>, <em>kind</em>, <em>period</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.ohlc" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the ohlc that we have so far for the given instrument.
Refer to AbstractStrategy.ohlc to see the meaning.
:param instrument_id: instrument id.
:param kind: string, ohlc kind.
:param period: Periodicity or float/int as volatility thresholds.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.on_market_rtn_depth_market_data">
<code class="descname">on_market_rtn_depth_market_data</code><span class="sig-paren">(</span><em>depth_market_data</em>, <em>trading_day</em>, <em>timestamp=None</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.on_market_rtn_depth_market_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Event that will be invoked when a tick data arrives from CTP.
Not all data producers need this.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.data_subscriptions">
<code class="descname">data_subscriptions</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.data_subscriptions" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of data subscriptions that current data producer relies on.
If current data producer does not rely on an data subscription, return an empty list.
The ZmqDataProducer needs to return data subscriptions which represent zmq connections.
:return: [AbstractDataSubscriber], the list of subscriptions.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.on_tick">
<code class="descname">on_tick</code><span class="sig-paren">(</span><em>instrument_id</em>, <em>tick</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.on_tick" title="Permalink to this definition">¶</a></dt>
<dd><p>Action to be invoked when a tick data from underlying data arrives.
:param instrument_id: string, the instrument id. This can be an actual instrument id or a relative id.</p>
<blockquote>
<div>It is can be a relative instrument id because the underlying data producer may be a zmq-based
producer, to which current strategy can register relative instruments.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tick</strong> &#8211; dict{string: object}, tick data.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.on_bar">
<code class="descname">on_bar</code><span class="sig-paren">(</span><em>kind</em>, <em>bars</em>, <em>tick</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.on_bar" title="Permalink to this definition">¶</a></dt>
<dd><p>Action to be called when a bar data arrives, either generated or received from zmq.
:param kind: string, the kind of ohlc. Valid values are from OhlcGeneratorConstants,</p>
<blockquote>
<div>such as &#8216;time-based&#8217;, &#8216;volatility-based&#8217;.</div></blockquote>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>bars</strong> &#8211; dict from Periodicity to Bar. keys are periodicities,
values are generated bars under such periodicities. It may contains more than one bars: a single
bar under each periodicity.</li>
<li><strong>tick</strong> &#8211; dict{string: object}, tick data..</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.backtesting_register_market_data">
<code class="descname">backtesting_register_market_data</code><span class="sig-paren">(</span><em>tick</em>, <em>dt</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.backtesting_register_market_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Register market data (used internally by backtester).
:param tick: dict{string: value}, tick data.
:param dt: datetime, current timestamp.</p>
</dd></dl>

<dl class="method">
<dt id="ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.backtesting_process_message">
<code class="descname">backtesting_process_message</code><span class="sig-paren">(</span><em>now</em><span class="sig-paren">)</span><a class="headerlink" href="#ctxalgoctp.ctp.data_producers.abstract_data_producer.AbstractDataProducer.backtesting_process_message" title="Permalink to this definition">¶</a></dt>
<dd><p>Process messages in the market message queue. (used internally by backtester).
The market message queue is maintained only in the backtesting market object.
:param now: datetime, current timestamp.
:return: bool, True if there is at least one message in the market message queue.</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="zmq_data_producer.html" class="btn btn-neutral float-right" title="zmq_data_producer" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="backtesting_data_producer.html" class="btn btn-neutral" title="backtesting_data_producer" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, .
      Last updated on Nov 01, 2016.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../static/jquery.js"></script>
      <script type="text/javascript" src="../../static/underscore.js"></script>
      <script type="text/javascript" src="../../static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>